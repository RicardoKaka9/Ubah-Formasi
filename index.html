<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Formasi(Sasono League)</title>
<style>
  body { font-family: Arial, sans-serif; background:#126412; color:white; text-align:center; margin:0; padding:0;}
  h1 { margin-top:20px;}
  .controls { margin:20px;}
  .field {
    position: relative; width:700px; height:900px; background:#228B22;
    margin:20px auto; border:4px solid white; border-radius:10px;
  }
  .position {
    position:absolute; width:100px; height:40px;
    background: rgba(255,255,255,0.25); border:1px solid #fff;
    border-radius:8px; cursor:pointer;
    display:flex; align-items:center; justify-content:center; font-weight:bold;
    transition:0.3s; user-select:none;
  }
  .invalid { background: rgba(255,0,0,0.4) !important;}
  .valid { background: rgba(0,255,0,0.4) !important;}
  .subs { position:absolute; right:-180px; top:100px; width:160px; display:flex; flex-direction:column; gap:10px;}
  select, button { margin:5px; padding:6px 10px; border-radius:5px; border:none; cursor:pointer;}
  #playerSelect { display:none;}
</style>
</head>
<body>

<h1>‚öΩSasono League</h1>

<div class="controls">
  <label>Pilih Club:</label>
  <select id="clubSelect">
    <option value="">-- Pilih Club --</option>
    <option value="Leverkusen">Leverkusen</option>
    <option value="Chelsea">Chelsea</option>
    <option value="Inter Milan">Inter Milan</option>
    <option value="AC Milan">AC Milan</option>
    <option value="Barcelona">Barcelona</option>
  </select>

  <label>Formasi:</label>
  <select id="formationSelect">
    <option value="4-3-3">4-3-3</option>
    <option value="4-3-3A">4-3-3 Attack</option>
    <option value="4-3-3D">4-3-3 Defense</option>
    <option value="4-2-1-3">4-2-1-3</option>
    <option value="4-2-1-3A">4-2-1-3 Attack</option>
    <option value="4-1-2-3">4-1-2-3</option>
    <option value="4-1-2-3D">4-1-2-3 Defense</option>
    <option value="4-2-3-1">4-2-3-1</option>
    <option value="3-5-2">3-5-2</option>
    <option value="4-2-4">4-2-4</option>
    <option value="3-4-2-1">3-4-2-1</option>
    <option value="3-1-4-2">3-1-4-2</option>
    <option value="3-6-1">3-6-1</option>
    <option value="2-3-5">2-3-5</option>
    <option value="3-4-3">3-4-3</option>
  </select>

  <button id="saveBtn">üíæ Simpan Lineup</button>
  <label>Pilih Kapten:</label>
  <select id="captainSelect"></select>
</div>

   <button id="infoButton">‚ÑπÔ∏è Info</button>

<script>
document.getElementById("infoButton").addEventListener("click", function() {
    window.location.href = "info.html";
});
</script>


<div class="field" id="field"></div>
<select id="playerSelect"></select>

<script>
// =================== BAGIAN 2: DATABASE PEMAIN ===================
const clubs = {
  "Leverkusen":[
    {name:"Emiliano Martinez",pos:["GK"]},{name:"Lucas Chevalier",pos:["GK"]},{name:"Niklas Lomb",pos:["GK"]},{name:"Matej Kovar",pos:["GK"]},{name:"Lukas Hradecky",pos:["GK"]},
    {name:"Lucio",pos:["CB"]},{name:"Nordi Mukiele",pos:["RB","CB"]},{name:"Murillo",pos:["CB"]},{name:"Soumaila Fofana",pos:["CB","DM"]},{name:"Jeanuel Belocian",pos:["CB","LB"]},{name:"Dean Huijsen",pos:["CB"]},{name:"Antonio Rudiger",pos:["CB"]},
    {name:"Arthur",pos:["RB","LB"]},{name:"Olivier Raterink",pos:["CM"]},
    {name:"Granit Xhaka",pos:["CM","DM"]},{name:"Alejandro Grimaldo",pos:["LB","LM","LW"]},{name:"Jonas Hofmann",pos:["RM","AM"]},{name:"Robert Andrich",pos:["DM","CM"]},{name:"Aleksandr Stepanov",pos:["CM"]},{name:"Amine Adli",pos:["LW","RW","AM"]},
    {name:"Martin Terrier",pos:["LW","ST"]},{name:"Nathan Tella",pos:["RW","LW"]},{name:"Ole Romeny",pos:["ST","RW","RM","AM"]},{name:"Frank Onyeka",pos:["DM","CM"]},{name:"Amir Aourir",pos:["CM"]},
    {name:"Nico Paz",pos:["AM","CM","LM"]},{name:"Rodrigo Mora",pos:["CM","AM"]},{name:"Luka Modric",pos:["CM","AM"]},
    {name:"Patrik Schick",pos:["ST"]},{name:"Erling Haaland",pos:["ST"]},{name:"Julian Alvarez",pos:["ST","AM","RM","RW"]}
  ],
  "Chelsea":[
    {name:"Giorgi Mamardashvili",pos:["GK"]},{name:"Filip Jorgensen",pos:["GK"]},{name:"Marcus Bettinelli",pos:["GK"]},
    {name:"Reece James",pos:["RB","RM","DM","CM"]},{name:"John Terry",pos:["CB"]},{name:"Wesley Fofana",pos:["CB"]},{name:"William Saliba",pos:["CB"]},{name:"Malo Gusto",pos:["RB","RM","CM","DM"]},
    {name:"Tosin Adarabioyo",pos:["CB"]},{name:"Joao Cancelo",pos:["RB","LB","RM","LM","CB"]},
    {name:"Alphonso Davies",pos:["LB","LW","LM"]},{name:"Marc Cucurella",pos:["LB","LM","CB"]},{name:"Renato Veiga",pos:["CB","DM"]},
    {name:"Enzo Fernandez",pos:["CM","DM","AM"]},{name:"Declan Rice",pos:["CM","DM"]},{name:"Moises Caicedo",pos:["DM","CM"]},{name:"Christopher Nkunku",pos:["AM","ST"]},
    {name:"Alex Matos",pos:["CM"]},{name:"Romeo Lavia",pos:["DM","CM"]},{name:"Cesare Casadei",pos:["CM","AM"]},{name:"Harvey Vale",pos:["AM","LW"]},
    {name:"Kai Havertz",pos:["AM","ST","CM","LB"]},{name:"Noni Madueke",pos:["RW","RM"]},{name:"Raheem Sterling",pos:["LW","RW","LM","ST"]},{name:"Jadon Sancho",pos:["LW","RW","AM","LM","RM"]},
    {name:"Victor Osimhen",pos:["ST"]},{name:"Antony",pos:["RW","LW","RM"]},{name:"Cole Palmer",pos:["RW","AM","RM"]},{name:"Joao Felix",pos:["AM","ST","LW","LM"]},{name:"Khvicha Kvaratskhelia",pos:["LW","RW","LM","RM","ST"]}
  ],
  "Inter Milan":[
    {name:"Sommer", pos:["GK"]},{name:"Josep Martinez", pos:["GK"]},{name:"Radu", pos:["GK"]},{name:"Di gennaro", pos:["GK"]},
    {name:"De vrij", pos:["CB"]},{name:"Acerbi", pos:["CB"]},{name:"Bastoni", pos:["CB"]},{name:"Bisseck", pos:["CB"]},
    {name:"Darmian", pos:["RB","LB"]},{name:"Gerard Martin", pos:["LB","LM"]},{name:"Palacios", pos:["CM"]},{name:"Kyle Walker", pos:["RB","RM"]},
    {name:"√áalhanoƒülu", pos:["DM","CM"]},{name:"Mkhitaryan", pos:["AM"]},{name:"Barella", pos:["CM"]},{name:"De jong", pos:["CM","DM"]},
    {name:"Asllani", pos:["AM"]},{name:"Zielinski", pos:["CM"]},{name:"Carlos Augusto", pos:["LB"]},{name:"Buchanan", pos:["LB","CB"]},
    {name:"Dumfries", pos:["RB"]},{name:"Walker", pos:["RB"]},{name:"Salcedo", pos:["ST"]},{name:"J. Correa", pos:["ST"]},
    {name:"M. Taremi", pos:["ST"]},{name:"V√≠ctor Gyokeres", pos:["ST"]},{name:"Alexander Isak", pos:["ST"]}
  ],
  "AC Milan":[
    {name:"Gianluigi Donnarumma",pos:["GK"]},{name:"Lapo Nava",pos:["GK"]},{name:"Lorenzo Torriani",pos:["GK"]},
    {name:"Levi Colwill",pos:["CB","LB"]},{name:"Davide Calabria",pos:["RB"]},{name:"Fikayo Tomori",pos:["CB"]},{name:"Josh Acheampong",pos:["CB","RB"]},{name:"Federico Dimarco",pos:["LB","LM"]},{name:"Alejandro Balde",pos:["LB","LM","LW"]},{name:"Pau Cubarsi",pos:["CB"]},{name:"Malick Thiaw",pos:["CB"]},{name:"Jeremie Frimpong",pos:["RB","RM","RW"]},{name:"Matteo Gabbia",pos:["CB"]},
    {name:"Emerson Royal",pos:["RB"]},{name:"Fode Ballo-Toure",pos:["LB"]},{name:"Alex Jimenez",pos:["RB","LB"]},{name:"Davide Bartesaghi",pos:["LB"]},
    {name:"Tijjani Reijnders",pos:["CM","DM","AM"]},{name:"Pablo Gavi",pos:["CM"]},{name:"Joao Neves",pos:["DM","CM"]},{name:"Ricardo Kaka",pos:["AM"]},{name:"Florian Wirtz",pos:["AM","CM","LW"]},{name:"Youssouf Fofana",pos:["DM"]},{name:"Ismael Bennacer",pos:["CM","DM"]},{name:"Yunus Musah",pos:["CM"]},{name:"Francesco Terracciano",pos:["RB"]},{name:"Kevin Zeroli",pos:["CM"]},{name:"Mattia Liberali",pos:["AM"]},
    {name:"Pedro Neto",pos:["RW","AM","RM","LM","ST","LW"]},{name:"Marc Guiu",pos:["ST"]},{name:"Christian Pulisic",pos:["RW","RM","LM","ST","AM","LW"]},{name:"Samuel Chukwueze",pos:["RW"]},{name:"Alvaro Morata",pos:["ST"]},{name:"Desire Doue",pos:["AM","LW","CM","LM","RW"]},{name:"Joshua Zirkzee",pos:["ST"]},{name:"Luka Jovic",pos:["ST"]},{name:"Noah Okafor",pos:["LW","ST"]},{name:"Cheick Traore",pos:["LB"]}
  ],
  "Barcelona":[
    {name:"Diogo Costa",pos:["GK"]},{name:"Inaki Pena",pos:["GK"]},{name:"Astralaga",pos:["GK"]},
    {name:"Sergi Dominguez",pos:["CB"]},{name:"Eric Garcia",pos:["CB","DM"]},{name:"Andreas Christensen",pos:["CB","DM"]},{name:"Inigo Martinez",pos:["CB"]},{name:"Jules Kounde",pos:["CB","RB"]},{name:"Ronald Araujo",pos:["CB"]},{name:"Theo Hernandez",pos:["LB","LM","LW"]},
    {name:"Dewsbury-Hall",pos:["CM","AM"]},{name:"Marc Bernal",pos:["DM"]},{name:"Pedri",pos:["CM","AM"]},{name:"Fermin Lopez",pos:["AM","CM","LM"]},{name:"Dani Olmo",pos:["AM","LW"]},{name:"Marc Casado",pos:["DM","CM"]},
    {name:"Johan Cruyff",pos:["ST","AM"]},{name:"Ansu Fati",pos:["LW","RW"]},{name:"Pau Victor",pos:["ST"]},{name:"Raphinha",pos:["RW","LW","LM","RM","AM"]},{name:"Robert Lewandowski",pos:["ST"]},{name:"Nico Williams",pos:["LW","RW"]},
    {name:"Ousmane Dembele",pos:["RW","LW","ST","RM"]},{name:"Victor Roque",pos:["ST"]},{name:"Lamine Yamal",pos:["RW","RM"]},{name:"Lautaro Martinez",pos:["ST"]},{name:"Ferran Torres",pos:["LW","ST"]}
  ]
};

// =================== BAGIAN 1: POSISI FIELD ===================
const field = document.getElementById('field');
const clubSelect = document.getElementById('clubSelect');
const formationSelect = document.getElementById('formationSelect');
const saveBtn = document.getElementById('saveBtn');
const captainSelect = document.getElementById('captainSelect');
const playerSelect = document.getElementById('playerSelect');

const defaultPositions = [
  {id:'GK', label:'GK', top:800, left:300},
  {id:'CB1', label:'CB', top:650, left:200},
  {id:'CB2', label:'CB', top:650, left:400},
  {id:'LB', label:'LB', top:650, left:100},
  {id:'RB', label:'RB', top:650, left:500},
  {id:'CM1', label:'CM', top:500, left:200},
  {id:'CM2', label:'CM', top:500, left:400},
  {id:'CM3', label:'CM', top:500, left:300},
  {id:'LW', label:'LW', top:350, left:100},
  {id:'RW', label:'RW', top:350, left:500},
  {id:'ST', label:'ST', top:200, left:300}
];

const formations = {
  "4-3-3":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'CM1', label:'CM', top:500, left:200},
    {id:'CM2', label:'CM', top:500, left:400},
    {id:'CM3', label:'CM', top:500, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-3-3A":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'CM1', label:'CM', top:500, left:200},
    {id:'CM2', label:'CM', top:500, left:400},
    {id:'AM', label:'AM', top:440, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-3-3D":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'CM1', label:'CM', top:500, left:200},
    {id:'CM2', label:'CM', top:500, left:400},
    {id:'DM', label:'DM', top:560, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-2-1-3":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'DM1', label:'DM', top:560, left:200},
    {id:'DM2', label:'DM', top:560, left:400},
    {id:'CM', label:'CM', top:500, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-2-1-3A":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'DM1', label:'DM', top:560, left:200},
    {id:'DM2', label:'DM', top:560, left:400},
    {id:'AM', label:'AM', top:440, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-1-2-3":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'AM1', label:'AM', top:440, left:200},
    {id:'AM2', label:'AM', top:440, left:400},
    {id:'CM', label:'CM', top:500, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-1-2-3D":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'AM1', label:'AM', top:440, left:200},
    {id:'AM2', label:'AM', top:440, left:400},
    {id:'DM', label:'DM', top:560, left:300},
    {id:'LW', label:'LW', top:350, left:100},
    {id:'RW', label:'RW', top:350, left:500},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "4-2-3-1":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:200},
    {id:'CB2', label:'CB', top:650, left:400},
    {id:'LB', label:'LB', top:650, left:100},
    {id:'RB', label:'RB', top:650, left:500},
    {id:'DM1', label:'DM', top:500, left:200},
    {id:'DM2', label:'DM', top:500, left:400},
    {id:'AM1', label:'AM', top:350, left:150},
    {id:'AM2', label:'AM', top:350, left:300},
    {id:'AM3', label:'AM', top:350, left:450},
    {id:'ST', label:'ST', top:200, left:300}
  ],
  "3-5-2":[
    {id:'GK', label:'GK', top:800, left:300},
    {id:'CB1', label:'CB', top:650, left:150},
    {id:'CB2', label:'CB', top:650, left:300},
    {id:'CB3', label:'CB', top:650, left:450},
    {id:'LM', label:'LM', top:500, left:100},
    {id:'CM1', label:'CM', top:500, left:200},
    {id:'CM2', label:'CM', top:500, left:300},
    {id:'CM3', label:'CM', top:500, left:400},
    {id:'RM', label:'RM', top:500, left:500},
    {id:'ST1', label:'ST', top:350, left:200},
    {id:'ST2', label:'ST', top:350, left:400}
  ],
"4-2-4":[
  {id:'GK', label:'GK', top:800, left:300},
  {id:'LB', label:'LB', top:650, left:100},
  {id:'CB1', label:'CB', top:650, left:200},
  {id:'CB2', label:'CB', top:650, left:400},
  {id:'RB', label:'RB', top:650, left:500},
  {id:'CM1', label:'CM', top:500, left:250},
  {id:'CM2', label:'CM', top:500, left:350},
  {id:'LW', label:'LW', top:350, left:100},
  {id:'ST1', label:'ST', top:230, left:250},
  {id:'ST2', label:'ST', top:230, left:350},
  {id:'RW', label:'RW', top:350, left:500}
],
"3-4-2-1":[
  {id:'GK', label:'GK', top:800, left:300},
  {id:'CB1', label:'CB', top:650, left:150},
  {id:'CB2', label:'CB', top:650, left:300},
  {id:'CB3', label:'CB', top:650, left:450},
  {id:'LM', label:'LM', top:500, left:100},
  {id:'CM1', label:'CM', top:500, left:200},
  {id:'CM2', label:'CM', top:500, left:400},
  {id:'RM', label:'RM', top:500, left:500},
  {id:'AM1', label:'AM', top:350, left:250},
  {id:'AM2', label:'AM', top:350, left:350},
  {id:'ST', label:'ST', top:200, left:300}
],
"3-1-4-2": [
  { id: 'GK', label: 'GK', top: 800, left: 300 },
  { id: 'CB1', label: 'CB', top: 650, left: 150 },
  { id: 'CB2', label: 'CB', top: 650, left: 300 },
  { id: 'CB3', label: 'CB', top: 650, left: 450 },
  { id: 'CDM', label: 'CDM', top: 575, left: 300 },
  { id: 'LM', label: 'LM', top: 500, left: 100 },
  { id: 'LCM', label: 'CM', top: 500, left: 220 },
  { id: 'RCM', label: 'CM', top: 500, left: 380 },
  { id: 'RM', label: 'RM', top: 500, left: 500 },
  { id: 'ST1', label: 'ST', top: 350, left: 250 },
  { id: 'ST2', label: 'ST', top: 350, left: 350 }
],
"3-6-1": [
  { id: 'GK', label: 'GK', top: 800, left: 300 },
  { id: 'CB1', label: 'CB', top: 650, left: 150 },
  { id: 'CB2', label: 'CB', top: 650, left: 300 },
  { id: 'CB3', label: 'CB', top: 650, left: 450 },
  { id: 'LCM', label: 'CM', top: 550, left: 200 },
  { id: 'CM', label: 'CM', top: 550, left: 300 },
  { id: 'RCM', label: 'CM', top: 550, left: 400 },
  { id: 'LAM', label: 'AM', top: 450, left: 250 },
  { id: 'RAM', label: 'AM', top: 450, left: 350 },
  { id: 'ST', label: 'ST', top: 300, left: 300 }
],
"2-3-5": [
  { id: 'GK', label: 'GK', top: 800, left: 300 },
  { id: 'CB1', label: 'CB', top: 650, left: 200 },
  { id: 'CB2', label: 'CB', top: 650, left: 400 },
  { id: 'LM', label: 'LM', top: 525, left: 150 },
  { id: 'CM', label: 'CM', top: 525, left: 300 },
  { id: 'RM', label: 'RM', top: 525, left: 450 },
  { id: 'LW', label: 'LW', top: 400, left: 100 },
  { id: 'LAM', label: 'AM', top: 400, left: 225 },
  { id: 'ST', label: 'ST', top: 340, left: 300 },
  { id: 'RAM', label: 'AM', top: 400, left: 375 },
  { id: 'RW', label: 'RW', top: 400, left: 500 }
],
"3-4-3": [
  { id: 'GK', label: 'GK', top: 800, left: 300 },
  { id: 'CB1', label: 'CB', top: 650, left: 150 },
  { id: 'CB2', label: 'CB', top: 650, left: 300 },
  { id: 'CB3', label: 'CB', top: 650, left: 450 },
  { id: 'LM', label: 'LM', top: 500, left: 100 },
  { id: 'CM1', label: 'CM', top: 500, left: 250 },
  { id: 'CM2', label: 'CM', top: 500, left: 350 },
  { id: 'RM', label: 'RM', top: 500, left: 500 },
  { id: 'LW', label: 'LW', top: 350, left: 150 },
  { id: 'ST', label: 'ST', top: 300, left: 300 },
  { id: 'RW', label: 'RW', top: 350, left: 450 }
]
};

formationSelect.addEventListener('change', ()=>{
  const f = formationSelect.value;
  if(!f) return;

  // Hapus posisi lama
  document.querySelectorAll('.position').forEach(p=>p.remove());

  // Buat posisi baru
  formations[f].forEach(p=>createPosition(p.id,p.label,p.top,p.left));
});

function createPosition(id, label, top, left){
  const div=document.createElement('div');
  div.className='position'; div.id=id; div.style.top=top+'px'; div.style.left=left+'px';
  div.innerText=label; div.dataset.pos=label;
  field.appendChild(div);
}
defaultPositions.forEach(p=>createPosition(p.id,p.label,p.top,p.left));

// =================== BAGIAN 3: LOGIKA ===================
function populatePlayerSelect(clubName) {
  playerSelect.innerHTML = '';
  clubs[clubName].forEach(p=>{
    const opt = document.createElement('option'); opt.value=p.name; opt.innerText=p.name;
    playerSelect.appendChild(opt);
  });
  captainSelect.innerHTML='<option value="">-- Pilih Kapten --</option>';
  clubs[clubName].forEach(p=>{
    const opt=document.createElement('option'); opt.value=p.name; opt.innerText=p.name;
    captainSelect.appendChild(opt);
  });
}

field.addEventListener('click', e => {
  // Hanya kalau yang diklik adalah slot posisi
  if (!e.target.classList.contains('position')) return;

  const slot = e.target;

  // Tampilkan dropdown pemain saat posisi diklik
  playerSelect.style.display = 'inline';
  playerSelect.value = ""; // reset pilihan sebelumnya

  playerSelect.onchange = function() {
    const playerName = playerSelect.value;
    if(!playerName) return;

    slot.innerText = playerName;

    const clubName = clubSelect.value;
    const player = clubs[clubName].find(p => p.name === playerName);

    // Warna hijau kalau posisi valid, merah kalau tidak
    if (player && player.pos.includes(slot.dataset.pos)) {
      slot.classList.remove('invalid');
      slot.classList.add('valid');
    } else {
      slot.classList.remove('valid');
      slot.classList.add('invalid');
    }
  }
});

saveBtn.onclick = ()=>{
  const lineup={};
  defaultPositions.forEach(p=>{
    const el=document.getElementById(p.id); lineup[p.id]=el.innerText||"";
  });
  const subs=[]; document.querySelectorAll('.sub').forEach(s=>subs.push(s.innerText));
  const captain=captainSelect.value;
  const data={lineup, subs, captain};
  const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
  const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='lineup.json'; a.click();
  URL.revokeObjectURL(url);
};

// =================== FITUR KAPTEN ===================
captainSelect.onchange = ()=>{
  const captainName = captainSelect.value;

  // Hapus tanda (C) lama di semua posisi
  document.querySelectorAll('.position').forEach(pos=>{
    pos.innerText = pos.innerText.replace(" (C)", "");
  });

  // Tambahkan tanda (C) di pemain yang dipilih sebagai kapten
  document.querySelectorAll('.position').forEach(pos=>{
    if(pos.innerText === captainName){
      pos.innerText = pos.innerText + " (C)";
    }
  });
};

clubSelect.addEventListener('change', ()=>{
  const clubName=clubSelect.value; if(!clubName) return; populatePlayerSelect(clubName);
  defaultPositions.forEach(p=>{ const el=document.getElementById(p.id); el.innerText=p.label; el.classList.remove('valid','invalid');});
});
</script>
</body>
</html>
